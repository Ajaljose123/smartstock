<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Supplier Dashboard - SmartStock</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; }
    
    /* Material UI style buttons */
    .material-btn {
      @apply px-4 py-2 rounded-full font-semibold text-white transition transform shadow-md hover:scale-105 relative overflow-hidden;
    }
    .btn-approve { background: linear-gradient(90deg, #34d399, #10b981); }
    .btn-approve:hover { background: linear-gradient(90deg, #10b981, #059669); }
    .btn-reject { background: linear-gradient(90deg, #f87171, #ef4444); }
    .btn-reject:hover { background: linear-gradient(90deg, #ef4444, #b91c1c); }
    .btn-new-request { background: linear-gradient(90deg, #3b82f6, #2563eb); }
    .btn-new-request:hover { background: linear-gradient(90deg, #2563eb, #1d4ed8); }

    /* Ripple effect */
    .material-btn:active::after {
      content: "";
      position: absolute;
      left: 50%;
      top: 50%;
      width: 120%;
      height: 120%;
      background: rgba(255,255,255,0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%) scale(0);
      animation: ripple 0.6s linear;
    }
    @keyframes ripple {
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    /* Status badges */
    .status-badge { @apply px-2 py-1 rounded-full text-sm font-semibold; }
    .status-pending { @apply bg-yellow-400 text-gray-800; }
    .status-approved { @apply bg-green-500 text-white; }
    .status-rejected { @apply bg-red-500 text-white; }

    /* Table hover effect */
    table tbody tr:hover { @apply bg-gray-50; }
  </style>
</head>
<body class="bg-gray-100 text-gray-900">

  <!-- Sidebar -->
  <div class="flex min-h-screen">
    <aside class="w-64 bg-gray-900 text-white p-6 flex flex-col">
      <h2 class="text-3xl font-bold mb-6 text-center text-blue-400">SmartStock</h2>
      <nav class="flex flex-col space-y-2">
        <a href="{% url 'supplier_dashboard' %}" class="px-4 py-2 rounded hover:bg-gray-700 transition flex items-center gap-2">ğŸ“¦ Dashboard</a>
        <a href="{% url 'supplier_orders' %}" class="px-4 py-2 rounded hover:bg-gray-700 transition flex items-center gap-2">ğŸ“‹ My Orders</a>
        <a href="{% url 'supplier_request_product' %}" class="px-4 py-2 rounded hover:bg-gray-700 transition flex items-center gap-2">â• Request Order</a>
        <a href="{% url 'supplier_requests' %}" class="px-4 py-2 rounded hover:bg-gray-700 transition flex items-center gap-2">ğŸ“‹ My Requests</a>
        <a href="{% url 'logout' %}" class="px-4 py-2 rounded hover:bg-red-600 transition flex items-center gap-2 mt-auto">ğŸšª Logout</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8">
      <h1 class="text-3xl font-bold mb-6 text-gray-800">ğŸ‘¨â€ğŸ’¼ Supplier Dashboard</h1>

      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-gradient-to-r from-blue-400 to-blue-600 shadow-lg rounded-lg p-6 text-center text-white hover:shadow-2xl transition">
          <h3 class="text-lg font-medium">Total Orders</h3>
          <p class="text-3xl font-bold">{{ total_orders }}</p>
        </div>
        <div class="bg-gradient-to-r from-yellow-400 to-yellow-500 shadow-lg rounded-lg p-6 text-center text-white hover:shadow-2xl transition">
          <h3 class="text-lg font-medium">Pending Deliveries</h3>
          <p class="text-3xl font-bold">{{ pending_orders }}</p>
        </div>
        <div class="bg-gradient-to-r from-green-400 to-green-600 shadow-lg rounded-lg p-6 text-center text-white hover:shadow-2xl transition">
          <h3 class="text-lg font-medium">Completed Deliveries</h3>
          <p class="text-3xl font-bold">{{ delivered_orders }}</p>
        </div>
      </div>

      <!-- Product Requests -->
      <div class="bg-white shadow-md rounded-lg p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-semibold text-gray-800">ğŸ“¦ Product Requests</h2>
          <form action="{% url 'supplier_request_product' %}">
            <button type="submit" class="material-btn btn-new-request">â• New Request</button>
          </form>
        </div>

        <div class="overflow-x-auto">
          <table class="table table-hover w-full text-left">
            <thead class="bg-gray-100 text-gray-900">
              <tr>
                <th>#</th>
                <th>Product</th>
                <th>Description</th>
                <th>Quantity</th>
                <th>Price/Unit</th>
                <th>Status</th>
                <th>Requested On</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for req in product_requests %}
              <tr class="hover:bg-gray-50">
                <td>{{ forloop.counter }}</td>
                <td>{{ req.product_name }}</td>
                <td>{{ req.description|default:"â€”" }}</td>
                <td>{{ req.quantity }}</td>
                <td>â‚¹{{ req.price_per_unit }}</td>
                <td>
                  {% if req.status == "pending" %}
                    <span class="status-badge status-pending">Pending</span>
                  {% elif req.status == "approved" %}
                    <span class="status-badge status-approved">Approved</span>
                  {% elif req.status == "rejected" %}
                    <span class="status-badge status-rejected">Rejected</span>
                  {% endif %}
                </td>
                <td>{{ req.created_at|date:"d M Y, H:i" }}</td>
                <td class="flex gap-2 relative">
                  {% if req.status == "pending" %}
                  <form method="POST" action="{% url 'approve_request' req.id %}">
                    {% csrf_token %}
                    <button type="submit" class="material-btn btn-approve">Approve</button>
                  </form>
                  <form method="POST" action="{% url 'reject_request' req.id %}">
                    {% csrf_token %}
                    <button type="submit" class="material-btn btn-reject">Reject</button>
                  </form>
                  {% else %}
                  <span class="text-gray-500">â€”</span>
                  {% endif %}
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="8" class="text-center text-gray-400">No product requests available</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

    </main>
  </div>

</body>
</html>
